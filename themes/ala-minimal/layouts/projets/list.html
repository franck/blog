{{ define "main" }}
<div class="list-page">
  <header class="list-header">
    <h1>{{ .Title }}</h1>
    {{- with .Description }}
    <p class="list-description">{{ . }}</p>
    {{- end }}
  </header>

  <div class="post-list">
    {{/* List all pages recursively in this section */}}
    {{- range .Sections }}
    <section class="project-category">
      <h2><a href="{{ .Permalink }}">{{ .Title }}</a></h2>
      {{- with .Description }}
      <p class="category-description">{{ . }}</p>
      {{- end }}
      
      {{/* List pages in this subsection */}}
      {{- range .Pages }}
      <article class="post-summary">
        <h3 class="post-summary-title">
          <a href="{{ .Permalink }}">{{ .Title }}</a>
        </h3>
        <div class="post-summary-meta">
          <time datetime="{{ .Date.Format "2006-01-02" }}">
            {{ .Date.Format "2 January 2006" }}
          </time>
        </div>
        {{- if .Description }}
        <p class="post-summary-description">{{ .Description }}</p>
        {{- end }}
      </article>
      {{- end }}
    </section>
    {{- end }}

    {{/* Also list direct pages if any */}}
    {{- range .RegularPages }}
    <article class="post-summary">
      <h2 class="post-summary-title">
        <a href="{{ .Permalink }}">{{ .Title }}</a>
      </h2>
      <div class="post-summary-meta">
        <time datetime="{{ .Date.Format "2006-01-02" }}">
          {{ .Date.Format "2 January 2006" }}
        </time>
      </div>
      {{- if .Description }}
      <p class="post-summary-description">{{ .Description }}</p>
      {{- end }}
    </article>
    {{- end }}
  </div>
</div>
{{ end }}
